import pandas as pd
import matplotlib as plt
import dearpygui.dearpygui as dpg
from importlib.metadata import version as pkg_version
from packaging import version
import sys
import os
from time import sleep

def clear(): # clears terminal instantly
    os.system('cls' if os.name == 'nt' else 'clear')

def clear_terminal(): #clears terminal with a delay
    sleep(2)
    os.system('cls' if os.name == 'nt' else 'clear')

def clear_delay(): #clears terminal with a short delay
    sleep(0.3)
    os.system('cls' if os.name == 'nt' else 'clear')

clear()

#loading screen
print("Initializing...")
clear_delay()
load = 0
print("Loading - ", load, "%")
clear_delay()
while load <= 99:
    load = load + 25
    print("Loading - ", load, "%")
    clear_delay()
print("Loading - Complete!")
clear_terminal()

print("Checking app dependencies versions.")
sleep(2)
print("Pandas Version:", pd.__version__)
print("Matplotlib Version:", plt.__version__)
print("DearPyGui Version:", pkg_version("dearpygui"))
clear_terminal()

outdated = []

if version.parse(pd.__version__) < version.parse("2.3.3"):
    outdated.append("Pandas")

if version.parse(plt.__version__) < version.parse("3.10.8"):
    outdated.append("Matplotlib")

if version.parse(pkg_version("dearpygui")) < version.parse("2.1.1"):
    outdated.append("DearPyGui")

if outdated:
    print(
        "Application cannot continue due to outdated dependencies:",
        ", ".join(outdated),
        "\nPlease update the dependencies."
    )
    sys.exit()

print("All dependencies are up to date. Launching Pokedex...")

